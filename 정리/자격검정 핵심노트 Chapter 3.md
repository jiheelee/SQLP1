### 자격검정 핵심노트 Chapter 3

#### 2 - 테이블 액세스 최소화

32. 인덱스 ROWID는 테이블 레코드와 직접 연결된 구조가 아니다. 데이터파일 상에서 테이블 레코드를 찾아가기 위한 논리적인 주소 정보다.

    인덱스 ROWID에 포함된 데이터 블록 주소(=데이터파일번호 + 블록번호)는 디스크 상의 블록 주소지만, 블록을 매번 데이터 파일에서 읽는다면 성능은 이루 말할 수 없이 느리다.I/O 성능을 위한 버퍼캐시 활용이 필수인 이유다. ROWID가 가리키는 블록을 버퍼캐시에 적재한 후에 읽는다.

    캐시에서 블록을 읽을 때는 읽고자하는 데이터 블록 주소를 해시 함수에 입력해서 해시 체인을 찾고 거기서 버퍼 헤더를 찾는다. 캐시에 적재할 때와 읽을 때 같은 해시함수를 사용하므로 버퍼 헤더는 항상 같은 해시체인에 연결된다. 반면, 실제 데이터가 담긴 버퍼 블록은 매번 다른 위치에 캐싱되는데, 그 메모리 주소값을 버퍼 헤더가 가지고 있다. 버퍼캐시는 시스템 공유 메모리에 위치하므로 액세스를 직렬화하기 위한 Lock 매커니즘이 작동한다. 따라서 버퍼캐시에서 블록을 읽을 때마다 Latch와 Buffer Lock 을 획득해야 한다. 동시 액세스가 심할 때는 Latch와 Buffer Lock 에 대한 경합까지 발생하므로 인덱스 ROwid를 이용한 테이블 액세스는 생각보다 고비용 구조다.

33. 인덱스를 아무리 재생성해도 클러스터링 팩터는 좋아지지 않는다. 클러스터링 팩터를 좋게 하려면, 인덱스 컬럼 순으로 정렬되도록 테이블을 재생성해야한다.

    클러스터링 팩터는 통계정보의 일종으로서 인덱스를 경유해 테이블 전체 로우를 액세스할때 읽을 것으로 예상되는 논리적인 블록 개수를 미리 구해 놓은 값이다.

36. 어떤 인덱스의 순서를 필터가 아닌 액세스만 일어나도록 변경하고 싶을 수 있다. 하지만, 변경하기 위해서는 많은 영향이 따른다. 다른 곳에서는 지금의 인덱스 순서가 최적일 수 있기 때문이다. 따라서 현실적인 방안으로는 인덱스 컬럼만을 추가해서 테이블 랜덤 액세스 감소만 실현시키는 것이 좋을 수 있다.

37. 랜덤 액세스 줄이는 방안 => 

    1) 인덱스 컬럼 추가

    2) IOT

    3) 인덱스 순으로 정렬되도록 테이블 재생성

    